(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{2677:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return R}));var n=a(48),c=a.n(n),o=a(2),i=a.n(o),s=a(11),l=a.n(s),r=a(1451),d=a(1171),u=a.n(d);function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.trimZero,n=void 0!==a&&a,c=String(e).padStart(2,"0").slice(-2);return n&&"00"===c?"".concat(Math.floor(e/100)):"".concat(Math.floor(e/100),".").concat(c)}var g={"淘宝":"taobao","天猫":"tmall","京东":"jingdong","京东自营":"jingdongSale","知乎":"zhihu","美团酒旅":"meituanhotel","苏宁":"suning","有赞":"youzan"},b=a(3),v=a.n(b),O=a(30),j=a(6),p={1:"正版保障 · 七天无理由退货",2:"正版保障 · 京东快递"},f=function(e){var t=e.className,a=e.style,n=e.id,c=e.skuId,i=e.imgUrl,s=e.title,r=e.price,d=void 0===r?0:r,u=e.source,b=e.productType,v=e.showBottomLine,f=void 0===v||v,h=e.abInfo,C=e.zaData,N=void 0===C?{}:C,k=e.onClick,y="¥ ".concat(m(parseInt(d))),w=u,I=(h||{}).params;"zhihu"===g[u]&&7===b&&(w="知乎 · 纸书");var S=(null==I?void 0:I.length)>0&&"0"!==I[0].value&&"zhihu"===g[u]&&7===b;Object(o.useEffect)((function(){(null==N?void 0:N.showId)&&O.a.trackCardShow(null,{id:null==N?void 0:N.showId,path:[{module_name:"".concat(n,"_").concat(c,"_").concat(g[u])}]})}),[]);return Object(j.g)("div",{className:l()("GoodsItemCard",t),style:a,onClick:function(){(null==N?void 0:N.clickId)&&O.a.trackEvent(null,{id:null==N?void 0:N.clickId,action:"OpenUrl",path:[{module_name:"".concat(n,"_").concat(c,"_").concat(g[u])}]}),"function"==typeof k&&k()}},Object(j.g)("div",{className:"GoodsItemCard-left"},Object(j.g)("div",{className:"GoodsItemCard-imgLayer"}),Object(j.g)("img",{className:"GoodsItemCard-imgUrl",src:i,alt:"",onError:function(){}})),Object(j.g)("div",{className:"GoodsItemCard-right"},Object(j.g)("div",{className:"GoodsItemCard-title"},s),Object(j.g)("div",{className:"GoodsItemCard-footer"},Object(j.g)("span",{className:"GoodsItemCard-price"},y),Object(j.g)("span",{className:"GoodsItemCard-footerText"},w)),S&&Object(j.g)("span",{className:"GoodsItemCard-footerIcon"},p[I[0].value])),Object(j.g)("div",{className:"GoodsItemCard-bottomLine",style:{display:f?"block":"none"}}))};f.prototype={className:v.a.string,style:v.a.object,imgUrl:v.a.string.isRequired,title:v.a.string.isRequired,price:v.a.number,source:v.a.string.isRequired,productType:v.a.number,showBottomLine:v.a.bool,onClick:v.a.func};var h=f,C=a(831),N=function(e){var t=e.className,a=e.style,n=e.id,c=e.skuId,s=e.imgUrl,r=e.title,d=e.price,u=void 0===d?0:d,b=e.source,v=e.showBottomLine,p=void 0!==v&&v,f=e.zaData,h=void 0===f?{}:f,N=e.onClick,k=e.tags,y="¥ ".concat(m(parseInt(u)));Object(o.useEffect)((function(){(null==h?void 0:h.showId)&&O.a.trackCardShow(null,{id:null==h?void 0:h.showId,path:[{module_name:"".concat(n,"_").concat(c,"_").concat(g[b])}]})}),[]);return Object(j.g)("div",{className:l()("GoodsItemNewCard",t),style:a,onClick:function(){(null==h?void 0:h.clickId)&&O.a.trackEvent(null,{id:null==h?void 0:h.clickId,action:"OpenUrl",path:[{module_name:"".concat(n,"_").concat(c,"_").concat(g[b])}]}),"function"==typeof N&&N()}},Object(j.g)("div",{className:"GoodsItemNewCard-left"},Object(j.g)("div",{className:"GoodsItemNewCard-imgLayer"}),Object(j.g)("img",{className:"GoodsItemNewCard-imgUrl",src:s,alt:"",onError:function(){}})),Object(j.g)("div",{className:"GoodsItemNewCard-right"},Object(j.g)("div",{className:"GoodsItemNewCard-title"},r),Object(j.g)("div",{className:"GoodsItemNewCard-footer"},Object(j.g)("span",{className:"GoodsItemNewCard-price"},y),(null==k?void 0:k.length)&&k.length>0&&Object(j.g)(i.a.Fragment,null,k.map((function(e,t){var a=e.value;return Object(j.g)("span",{key:"".concat(a,"#").concat(t),className:"GoodsItemNewCard-tag"},a)}))),Object(j.g)("div",{className:"GoodsItemNewCard-sourceIcon"},b,Object(j.g)(C.a,{size:20,center:!0})))),Object(j.g)("div",{className:"GoodsItemNewCard-bottomLine",style:{display:p?"block":"none"}}))};N.prototype={className:v.a.string,style:v.a.object,imgUrl:v.a.string.isRequired,title:v.a.string.isRequired,price:v.a.number,source:v.a.string.isRequired,productType:v.a.number,showBottomLine:v.a.bool,onClick:v.a.func,tags:v.a.array};var k=N,y=a(1710),w=a(28),I=a.n(w),S=function(){return Object(j.g)(i.a.Fragment,null)},G={SkeletonH01:function(e){var t=e.lineClass;return Object(j.g)(i.a.Fragment,null,Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t}))},SkeletonP01:function(e){var t=e.lineClass,a=e.blockClass;return Object(j.g)(i.a.Fragment,null,Object(j.g)("div",{className:a}),Object(j.g)("div",null,Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t})))},SkeletonT01:function(e){var t=e.lineClass;return Object(j.g)(i.a.Fragment,null,Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t}))},SkeletonT02:function(e){var t=e.lineClass;return Object(j.g)(i.a.Fragment,null,Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t}))},SkeletonC01:function(e){var t=e.lineClass,a=e.blockClass;return Object(j.g)(i.a.Fragment,null,Object(j.g)("div",{className:a}),Object(j.g)("div",null,Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t})))},SkeletonC02:function(e){var t=e.lineClass,a=e.blockClass;return Object(j.g)(i.a.Fragment,null,Object(j.g)("div",null,Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t})),Object(j.g)("div",{className:a}))},SkeletonC03:function(e){var t=e.lineClass,a=e.blockClass;return Object(j.g)(i.a.Fragment,null,Object(j.g)("div",{className:a}),Object(j.g)("div",{style:{width:"100%"}},Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t})))},SkeletonC04:function(e){var t=e.lineClass,a=e.blockClass;return Object(j.g)(i.a.Fragment,null,Object(j.g)("div",{className:"".concat(a,"-1")}),Object(j.g)("div",{className:a}),Object(j.g)("div",{style:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"}},Object(j.g)("div",{className:t}),Object(j.g)("div",{className:t})))},SkeletonI01:function(e){var t=e.blockClass;return Object(j.g)(i.a.Fragment,null,Object(j.g)("div",{className:t}))},SkeletonSpacing:S,SkeletonFill:S},_=i.a.memo((function(e){var t,a=e.variant,n=void 0===a?"H01":a,c=e.height,o=e.width,i=void 0===o?"auto":o,s=e.animation,r=void 0===s?"ease-in":s,d="skeleton__line--".concat(n.toLowerCase()),u="skeleton--".concat(n.toLowerCase()),m=l()(I()({skeleton__block:!0},"skeleton__block--".concat(n.toLowerCase()),!0)),g=l()(I()({skeleton__line:!0},d,!0)),b=l()((t={skeleton:!0},I()(t,u,!0),I()(t,"skeleton--ease-in","ease-in"===r),t)),v={width:i};c&&["Spacing","Fill"].includes(n)&&(v.height="number"==typeof c?"".concat(c,"px"):c);var O=G["Skeleton".concat(n)];return Object(j.g)("section",{className:b,style:v},Object(j.g)(O,{variant:n,lineClass:g,blockClass:m}))}));_.propTypes={variant:v.a.string,height:v.a.oneOfType([v.a.string,v.a.number]),width:v.a.oneOfType([v.a.string,v.a.number]),animation:v.a.oneOfType([v.a.bool,v.a.string])};var T=_;var L=i.a.memo((function(e){var t=e.content,a=function(e){return("string"==typeof e?e.split(","):e).map((function(e){var t=e.split("-"),a=c()(t,2),n=a[0],o=a[1];return["Spacing","Fill"].includes(n)?{type:n,height:+o}:{type:n,count:+o||1}}))}(void 0===t?"T01":t);return Object(j.g)(i.a.Fragment,null,a.map((function(e,t){var a=e.type,n=e.count,c=e.height;return n?Array.from({length:n}).map((function(e,n){return Object(j.g)(T,{variant:a,key:"".concat(t,"-").concat(n)})})):Object(j.g)(T,{variant:a,height:c,key:"".concat(t,"-").concat(c)})})))}));L.prototype={content:Object(b.oneOfType)([Object(b.arrayOf)(b.string),b.string])};var z=L,F=a(94),U={"京东":"jingdong","淘宝":"taobao","拼多多":"pinduoduo","苏宁":"suning","美团酒旅":"meituanhotel","知乎":"zhihu","有赞":"youzan"},E=function(e){var t=e.className,a=e.style,n=e.showModal,s=void 0===n||n,d=e.withModal,m=void 0===d||d,g=e.modalTitle,b=void 0===g?"该商品的所有购买渠道":g,v=e.id,p=e.url,f=void 0===p?"":p,C=e.fetcherOptions,N=void 0===C?{}:C,w=e.scenes,I=void 0===w?0:w,S=e.fetcher,G=void 0===S?r.a:S,_=e.onClose,T=e.onSelectCard;Object(F.g)();var L=Object(o.useState)(0),E=c()(L,2),R=E[0],x=E[1],B=Object(o.useState)(!1),M=c()(B,2),q=M[0],D=M[1],A=Object(o.useState)([]),P=c()(A,2),H=P[0],J=P[1],Z=Object(o.useState)(!1),K=c()(Z,2),Q=K[0],V=K[1],W=Object(o.useState)(null),X=c()(W,2),Y=X[0],$=X[1],ee=(H||[]).some((function(e){var t=e.product_type,a=e.ab;return 8===t&&"3"===(null==a?void 0:a.kepler)}));Object(o.useEffect)((function(){O.a.trackCardShow(null,{id:10331,path:[{module_name:v}]}),window.abInfo?$({params:[window.abInfo]}):Object(r.a)("/consume/bff/ab?name=book_kpwz").then((function(e){var t=e.data;t&&($({params:[t]}),window.abInfo=t)})).catch((function(){}))}),[]),Object(o.useEffect)((function(){D(!0);var e=f||"/api/v4/mcn/linkcard/".concat(v,"?scenes=").concat(I);G(e,N).then((function(e){var t=e.data,a=[];if(!u()(t)&&(a.push(Object.assign({},t,{children:null})),"[object Array]"===Object.prototype.toString.call(t.children)&&t.children.length&&(a=a.concat(t.children)),a.some((function(e){return 8===e.product_type})))){var n=[];a.forEach((function(e){"知乎"===e.source?n.unshift(e):n.push(e)})),a=n}J(a)})).catch((function(){V(!0)})).finally((function(){setTimeout((function(){D(!1)}),500)}))}),[v,R]);var te=function(e){T&&T(e)},ae=Object(j.g)("div",{className:"GoodsCardList-container"},q?Object(j.g)(i.a.Fragment,null,Object(j.g)(z,{content:"C03,Spacing-26,C03",height:72})):Q?Object(j.g)("div",{className:"GoodsCardList-error"},Object(j.g)("div",{className:"GoodsCardList-errorDesc"},"Oops~ 出错了"),Object(j.g)("div",{className:"GoodsCardList-errorBtn",onClick:function(){x(R+1)}},"刷新重试")):H.length?H.map((function(e){var t=e.id,a=e.skuid,n=e.title,c=e.url,o=e.img_url,i=e.price,s=e.source,l=e.product_type,r=e.tags;return Object(j.g)(F.b,{key:"".concat(s,"-").concat(t,"-").concat(a),block:"goodsRecommend_polymericCardPopup_goodsCard",content:{type:"GoodsRecommend",id:"".concat(t,"-").concat(a,"-").concat(U[s])},extra:{link:{url:c}}},Object(j.g)(F.e,{shouldTrackClick:!0,className:"GoodsCardList-listItem",zaType:"Card",zaText:n,zaAction:"OpenUrl",zaEventType:"Click",extra:{link:{url:c},configMap:{showLowPriceIconCard:ee&&"知乎"===s?"1":"0"}}},ee?Object(j.g)(k,{id:t,skuId:a,title:n,imgUrl:o,price:i,source:s,productType:l,showBottomLine:!1,zaData:{showId:10371,clickId:10372},onClick:function(){return te(e)},tags:r}):Object(j.g)(h,{id:t,skuId:a,title:n,imgUrl:o,price:i,source:s,productType:l,showBottomLine:!1,abInfo:Y,zaData:{showId:10371,clickId:10372},onClick:function(){return te(e)}})))})):null);return m?Object(j.g)(y.a,{className:l()("GoodsCardList",t),style:a,size:"large",title:b,onClose:_},s&&ae):ae};E.prototype={className:v.a.string,style:v.a.object,showModal:v.a.bool,withModal:v.a.bool,modalTitle:v.a.string,id:v.a.string,url:v.a.string,fetcherOptions:v.a.object,scenes:v.a.number,fetcher:v.a.func,onClose:v.a.func,onSelectCard:v.a.func};var R=E}}]);
//# sourceMappingURL=main.GoodsRecommendGoodsCardList.7e3e1697e9dad757081f.js.map